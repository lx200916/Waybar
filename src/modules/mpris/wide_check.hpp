// adapted from:
// - https://unicode.org/Public/UNIDATA/EastAsianWidth.txt
// - https://www.unicode.org/Public/UCD/latest/ucd/UnicodeData.txt
//
// 0 width is all characters from groups Cf, Cc, Mn, Me
// 2 width is all characters with East_Asian_Width F or W
// other chars are counted as 1

size_t char_width(uint32_t c) {
  switch (c) {
    case 0xAD:
    case 0x5BF:
    case 0x5C1:
    case 0x5C2:
    case 0x5C4:
    case 0x5C5:
    case 0x5C7:
    case 0x61C:
    case 0x670:
    case 0x6E7:
    case 0x6E8:
    case 0x70F:
    case 0x711:
    case 0x7FD:
    case 0x825:
    case 0x826:
    case 0x827:
    case 0x859:
    case 0x85A:
    case 0x85B:
    case 0x890:
    case 0x891:
    case 0x93A:
    case 0x93C:
    case 0x94D:
    case 0x962:
    case 0x963:
    case 0x981:
    case 0x9BC:
    case 0x9CD:
    case 0x9E2:
    case 0x9E3:
    case 0x9FE:
    case 0xA01:
    case 0xA02:
    case 0xA3C:
    case 0xA41:
    case 0xA42:
    case 0xA47:
    case 0xA48:
    case 0xA4B:
    case 0xA4C:
    case 0xA4D:
    case 0xA51:
    case 0xA70:
    case 0xA71:
    case 0xA75:
    case 0xA81:
    case 0xA82:
    case 0xABC:
    case 0xAC7:
    case 0xAC8:
    case 0xACD:
    case 0xAE2:
    case 0xAE3:
    case 0xB01:
    case 0xB3C:
    case 0xB3F:
    case 0xB4D:
    case 0xB55:
    case 0xB56:
    case 0xB62:
    case 0xB63:
    case 0xB82:
    case 0xBC0:
    case 0xBCD:
    case 0xC00:
    case 0xC04:
    case 0xC3C:
    case 0xC3E:
    case 0xC3F:
    case 0xC40:
    case 0xC46:
    case 0xC47:
    case 0xC48:
    case 0xC55:
    case 0xC56:
    case 0xC62:
    case 0xC63:
    case 0xC81:
    case 0xCBC:
    case 0xCBF:
    case 0xCC6:
    case 0xCCC:
    case 0xCCD:
    case 0xCE2:
    case 0xCE3:
    case 0xD00:
    case 0xD01:
    case 0xD3B:
    case 0xD3C:
    case 0xD4D:
    case 0xD62:
    case 0xD63:
    case 0xD81:
    case 0xDCA:
    case 0xDD2:
    case 0xDD3:
    case 0xDD4:
    case 0xDD6:
    case 0xE31:
    case 0xEB1:
    case 0xF18:
    case 0xF19:
    case 0xF35:
    case 0xF37:
    case 0xF39:
    case 0xF86:
    case 0xF87:
    case 0xFC6:
    case 0x1039:
    case 0x103A:
    case 0x103D:
    case 0x103E:
    case 0x1058:
    case 0x1059:
    case 0x105E:
    case 0x105F:
    case 0x1060:
    case 0x1082:
    case 0x1085:
    case 0x1086:
    case 0x108D:
    case 0x109D:
    case 0x135D:
    case 0x135E:
    case 0x135F:
    case 0x1712:
    case 0x1713:
    case 0x1714:
    case 0x1732:
    case 0x1733:
    case 0x1752:
    case 0x1753:
    case 0x1772:
    case 0x1773:
    case 0x17B4:
    case 0x17B5:
    case 0x17C6:
    case 0x17DD:
    case 0x1885:
    case 0x1886:
    case 0x18A9:
    case 0x1920:
    case 0x1921:
    case 0x1922:
    case 0x1927:
    case 0x1928:
    case 0x1932:
    case 0x1939:
    case 0x193A:
    case 0x193B:
    case 0x1A17:
    case 0x1A18:
    case 0x1A1B:
    case 0x1A56:
    case 0x1A60:
    case 0x1A62:
    case 0x1A7F:
    case 0x1B34:
    case 0x1B3C:
    case 0x1B42:
    case 0x1B80:
    case 0x1B81:
    case 0x1BA8:
    case 0x1BA9:
    case 0x1BAB:
    case 0x1BAC:
    case 0x1BAD:
    case 0x1BE6:
    case 0x1BE8:
    case 0x1BE9:
    case 0x1BED:
    case 0x1BEF:
    case 0x1BF0:
    case 0x1BF1:
    case 0x1C36:
    case 0x1C37:
    case 0x1CD0:
    case 0x1CD1:
    case 0x1CD2:
    case 0x1CED:
    case 0x1CF4:
    case 0x1CF8:
    case 0x1CF9:
    case 0x2CEF:
    case 0x2CF0:
    case 0x2CF1:
    case 0x2D7F:
    case 0x3099:
    case 0x309A:
    case 0xA69E:
    case 0xA69F:
    case 0xA6F0:
    case 0xA6F1:
    case 0xA802:
    case 0xA806:
    case 0xA80B:
    case 0xA825:
    case 0xA826:
    case 0xA82C:
    case 0xA8C4:
    case 0xA8C5:
    case 0xA8FF:
    case 0xA980:
    case 0xA981:
    case 0xA982:
    case 0xA9B3:
    case 0xA9BC:
    case 0xA9BD:
    case 0xA9E5:
    case 0xAA31:
    case 0xAA32:
    case 0xAA35:
    case 0xAA36:
    case 0xAA43:
    case 0xAA4C:
    case 0xAA7C:
    case 0xAAB0:
    case 0xAAB2:
    case 0xAAB3:
    case 0xAAB4:
    case 0xAAB7:
    case 0xAAB8:
    case 0xAABE:
    case 0xAABF:
    case 0xAAC1:
    case 0xAAEC:
    case 0xAAED:
    case 0xAAF6:
    case 0xABE5:
    case 0xABE8:
    case 0xABED:
    case 0xFB1E:
    case 0xFEFF:
    case 0xFFF9:
    case 0xFFFA:
    case 0xFFFB:
    case 0x101FD:
    case 0x102E0:
    case 0x10A01:
    case 0x10A02:
    case 0x10A03:
    case 0x10A05:
    case 0x10A06:
    case 0x10A38:
    case 0x10A39:
    case 0x10A3A:
    case 0x10A3F:
    case 0x10AE5:
    case 0x10AE6:
    case 0x10EAB:
    case 0x10EAC:
    case 0x10EFD:
    case 0x10EFE:
    case 0x10EFF:
    case 0x11001:
    case 0x11070:
    case 0x11073:
    case 0x11074:
    case 0x1107F:
    case 0x11080:
    case 0x11081:
    case 0x110B9:
    case 0x110BA:
    case 0x110BD:
    case 0x110C2:
    case 0x110CD:
    case 0x11100:
    case 0x11101:
    case 0x11102:
    case 0x11173:
    case 0x11180:
    case 0x11181:
    case 0x111CF:
    case 0x1122F:
    case 0x11230:
    case 0x11231:
    case 0x11234:
    case 0x11236:
    case 0x11237:
    case 0x1123E:
    case 0x11241:
    case 0x112DF:
    case 0x11300:
    case 0x11301:
    case 0x1133B:
    case 0x1133C:
    case 0x11340:
    case 0x11442:
    case 0x11443:
    case 0x11444:
    case 0x11446:
    case 0x1145E:
    case 0x114BA:
    case 0x114BF:
    case 0x114C0:
    case 0x114C2:
    case 0x114C3:
    case 0x115BC:
    case 0x115BD:
    case 0x115BF:
    case 0x115C0:
    case 0x115DC:
    case 0x115DD:
    case 0x1163D:
    case 0x1163F:
    case 0x11640:
    case 0x116AB:
    case 0x116AD:
    case 0x116B7:
    case 0x1171D:
    case 0x1171E:
    case 0x1171F:
    case 0x11839:
    case 0x1183A:
    case 0x1193B:
    case 0x1193C:
    case 0x1193E:
    case 0x11943:
    case 0x119DA:
    case 0x119DB:
    case 0x119E0:
    case 0x11A47:
    case 0x11A59:
    case 0x11A5A:
    case 0x11A5B:
    case 0x11A98:
    case 0x11A99:
    case 0x11C3F:
    case 0x11CB2:
    case 0x11CB3:
    case 0x11CB5:
    case 0x11CB6:
    case 0x11D3A:
    case 0x11D3C:
    case 0x11D3D:
    case 0x11D47:
    case 0x11D90:
    case 0x11D91:
    case 0x11D95:
    case 0x11D97:
    case 0x11EF3:
    case 0x11EF4:
    case 0x11F00:
    case 0x11F01:
    case 0x11F40:
    case 0x11F42:
    case 0x16F4F:
    case 0x16FE4:
    case 0x1BC9D:
    case 0x1BC9E:
    case 0x1D167:
    case 0x1D168:
    case 0x1D169:
    case 0x1D242:
    case 0x1D243:
    case 0x1D244:
    case 0x1DA75:
    case 0x1DA84:
    case 0x1E023:
    case 0x1E024:
    case 0x1E08F:
    case 0x1E2AE:
    case 0xE0001:
      return 0;

    case 0x231A:
    case 0x231B:
    case 0x2329:
    case 0x232A:
    case 0x23F0:
    case 0x23F3:
    case 0x25FD:
    case 0x25FE:
    case 0x2614:
    case 0x2615:
    case 0x267F:
    case 0x2693:
    case 0x26A1:
    case 0x26AA:
    case 0x26AB:
    case 0x26BD:
    case 0x26BE:
    case 0x26C4:
    case 0x26C5:
    case 0x26CE:
    case 0x26D4:
    case 0x26EA:
    case 0x26F2:
    case 0x26F3:
    case 0x26F5:
    case 0x26FA:
    case 0x26FD:
    case 0x2705:
    case 0x270A:
    case 0x270B:
    case 0x2728:
    case 0x274C:
    case 0x274E:
    case 0x2753:
    case 0x2754:
    case 0x2755:
    case 0x2757:
    case 0x2795:
    case 0x2796:
    case 0x2797:
    case 0x27B0:
    case 0x27BF:
    case 0x2B1B:
    case 0x2B1C:
    case 0x2B50:
    case 0x2B55:
    case 0x302E:
    case 0x302F:
    case 0x3030:
    case 0x3036:
    case 0x3037:
    case 0x309F:
    case 0x30A0:
    case 0x30FB:
    case 0x30FF:
    case 0x3250:
    case 0xA015:
    case 0xFE17:
    case 0xFE18:
    case 0xFE19:
    case 0xFE30:
    case 0x16FF0:
    case 0x16FF1:
    case 0x1B132:
    case 0x1B150:
    case 0x1B151:
    case 0x1B152:
    case 0x1B155:
    case 0x1F004:
    case 0x1F0CF:
    case 0x1F18E:
    case 0x1F200:
    case 0x1F201:
    case 0x1F202:
    case 0x1F250:
    case 0x1F251:
    case 0x1F3F4:
    case 0x1F440:
    case 0x1F57A:
    case 0x1F595:
    case 0x1F596:
    case 0x1F5A4:
    case 0x1F6CC:
    case 0x1F6D5:
    case 0x1F6D6:
    case 0x1F6D7:
    case 0x1F6EB:
    case 0x1F6EC:
    case 0x1F7F0:
      return 2;

    default:
      break;
  }

  if ((c >= 0x0 && c <= 0x1F) || (c >= 0x7F && c <= 0x9F) || (c >= 0x300 && c <= 0x36F) ||
      (c >= 0x483 && c <= 0x489) || (c >= 0x591 && c <= 0x5BD) || (c >= 0x600 && c <= 0x605) ||
      (c >= 0x610 && c <= 0x61A) || (c >= 0x64B && c <= 0x65F) || (c >= 0x6D6 && c <= 0x6DD) ||
      (c >= 0x6DF && c <= 0x6E4) || (c >= 0x6EA && c <= 0x6ED) || (c >= 0x730 && c <= 0x74A) ||
      (c >= 0x7A6 && c <= 0x7B0) || (c >= 0x7EB && c <= 0x7F3) || (c >= 0x816 && c <= 0x819) ||
      (c >= 0x81B && c <= 0x823) || (c >= 0x829 && c <= 0x82D) || (c >= 0x898 && c <= 0x89F) ||
      (c >= 0x8CA && c <= 0x902) || (c >= 0x941 && c <= 0x948) || (c >= 0x951 && c <= 0x957) ||
      (c >= 0x9C1 && c <= 0x9C4) || (c >= 0xAC1 && c <= 0xAC5) || (c >= 0xAFA && c <= 0xAFF) ||
      (c >= 0xB41 && c <= 0xB44) || (c >= 0xC4A && c <= 0xC4D) || (c >= 0xD41 && c <= 0xD44) ||
      (c >= 0xE34 && c <= 0xE3A) || (c >= 0xE47 && c <= 0xE4E) || (c >= 0xEB4 && c <= 0xEBC) ||
      (c >= 0xEC8 && c <= 0xECE) || (c >= 0xF71 && c <= 0xF7E) || (c >= 0xF80 && c <= 0xF84) ||
      (c >= 0xF8D && c <= 0xF97) || (c >= 0xF99 && c <= 0xFBC) || (c >= 0x102D && c <= 0x1030) ||
      (c >= 0x1032 && c <= 0x1037) || (c >= 0x1071 && c <= 0x1074) ||
      (c >= 0x17B7 && c <= 0x17BD) || (c >= 0x17C9 && c <= 0x17D3) ||
      (c >= 0x180B && c <= 0x180F) || (c >= 0x1A58 && c <= 0x1A5E) ||
      (c >= 0x1A65 && c <= 0x1A6C) || (c >= 0x1A73 && c <= 0x1A7C) ||
      (c >= 0x1AB0 && c <= 0x1ACE) || (c >= 0x1B00 && c <= 0x1B03) ||
      (c >= 0x1B36 && c <= 0x1B3A) || (c >= 0x1B6B && c <= 0x1B73) ||
      (c >= 0x1BA2 && c <= 0x1BA5) || (c >= 0x1C2C && c <= 0x1C33) ||
      (c >= 0x1CD4 && c <= 0x1CE0) || (c >= 0x1CE2 && c <= 0x1CE8) ||
      (c >= 0x1DC0 && c <= 0x1DFF) || (c >= 0x200B && c <= 0x200F) ||
      (c >= 0x202A && c <= 0x202E) || (c >= 0x2060 && c <= 0x2064) ||
      (c >= 0x2066 && c <= 0x206F) || (c >= 0x20D0 && c <= 0x20F0) ||
      (c >= 0x2DE0 && c <= 0x2DFF) || (c >= 0x302A && c <= 0x302D) ||
      (c >= 0xA66F && c <= 0xA672) || (c >= 0xA674 && c <= 0xA67D) ||
      (c >= 0xA8E0 && c <= 0xA8F1) || (c >= 0xA926 && c <= 0xA92D) ||
      (c >= 0xA947 && c <= 0xA951) || (c >= 0xA9B6 && c <= 0xA9B9) ||
      (c >= 0xAA29 && c <= 0xAA2E) || (c >= 0xFE00 && c <= 0xFE0F) ||
      (c >= 0xFE20 && c <= 0xFE2F) || (c >= 0x10376 && c <= 0x1037A) ||
      (c >= 0x10A0C && c <= 0x10A0F) || (c >= 0x10D24 && c <= 0x10D27) ||
      (c >= 0x10F46 && c <= 0x10F50) || (c >= 0x10F82 && c <= 0x10F85) ||
      (c >= 0x11038 && c <= 0x11046) || (c >= 0x110B3 && c <= 0x110B6) ||
      (c >= 0x11127 && c <= 0x1112B) || (c >= 0x1112D && c <= 0x11134) ||
      (c >= 0x111B6 && c <= 0x111BE) || (c >= 0x111C9 && c <= 0x111CC) ||
      (c >= 0x112E3 && c <= 0x112EA) || (c >= 0x11366 && c <= 0x1136C) ||
      (c >= 0x11370 && c <= 0x11374) || (c >= 0x11438 && c <= 0x1143F) ||
      (c >= 0x114B3 && c <= 0x114B8) || (c >= 0x115B2 && c <= 0x115B5) ||
      (c >= 0x11633 && c <= 0x1163A) || (c >= 0x116B0 && c <= 0x116B5) ||
      (c >= 0x11722 && c <= 0x11725) || (c >= 0x11727 && c <= 0x1172B) ||
      (c >= 0x1182F && c <= 0x11837) || (c >= 0x119D4 && c <= 0x119D7) ||
      (c >= 0x11A01 && c <= 0x11A0A) || (c >= 0x11A33 && c <= 0x11A38) ||
      (c >= 0x11A3B && c <= 0x11A3E) || (c >= 0x11A51 && c <= 0x11A56) ||
      (c >= 0x11A8A && c <= 0x11A96) || (c >= 0x11C30 && c <= 0x11C36) ||
      (c >= 0x11C38 && c <= 0x11C3D) || (c >= 0x11C92 && c <= 0x11CA7) ||
      (c >= 0x11CAA && c <= 0x11CB0) || (c >= 0x11D31 && c <= 0x11D36) ||
      (c >= 0x11D3F && c <= 0x11D45) || (c >= 0x11F36 && c <= 0x11F3A) ||
      (c >= 0x13430 && c <= 0x13440) || (c >= 0x13447 && c <= 0x13455) ||
      (c >= 0x16AF0 && c <= 0x16AF4) || (c >= 0x16B30 && c <= 0x16B36) ||
      (c >= 0x16F8F && c <= 0x16F92) || (c >= 0x1BCA0 && c <= 0x1BCA3) ||
      (c >= 0x1CF00 && c <= 0x1CF2D) || (c >= 0x1CF30 && c <= 0x1CF46) ||
      (c >= 0x1D173 && c <= 0x1D182) || (c >= 0x1D185 && c <= 0x1D18B) ||
      (c >= 0x1D1AA && c <= 0x1D1AD) || (c >= 0x1DA00 && c <= 0x1DA36) ||
      (c >= 0x1DA3B && c <= 0x1DA6C) || (c >= 0x1DA9B && c <= 0x1DA9F) ||
      (c >= 0x1DAA1 && c <= 0x1DAAF) || (c >= 0x1E000 && c <= 0x1E006) ||
      (c >= 0x1E008 && c <= 0x1E018) || (c >= 0x1E01B && c <= 0x1E021) ||
      (c >= 0x1E026 && c <= 0x1E02A) || (c >= 0x1E130 && c <= 0x1E136) ||
      (c >= 0x1E2EC && c <= 0x1E2EF) || (c >= 0x1E4EC && c <= 0x1E4EF) ||
      (c >= 0x1E8D0 && c <= 0x1E8D6) || (c >= 0x1E944 && c <= 0x1E94A) ||
      (c >= 0xE0020 && c <= 0xE007F) || (c >= 0xE0100 && c <= 0xE01EF)) {
    return 0;
  }

  if ((c >= 0x1100 && c <= 0x115F) || (c >= 0x23E9 && c <= 0x23EC) ||
      (c >= 0x2648 && c <= 0x2653) || (c >= 0x2E80 && c <= 0x2E99) ||
      (c >= 0x2E9B && c <= 0x2EF3) || (c >= 0x2F00 && c <= 0x2FD5) ||
      (c >= 0x2FF0 && c <= 0x2FFB) || (c >= 0x3000 && c <= 0x302D) ||
      (c >= 0x3031 && c <= 0x3035) || (c >= 0x3038 && c <= 0x303E) ||
      (c >= 0x3041 && c <= 0x3096) || (c >= 0x3099 && c <= 0x309E) ||
      (c >= 0x30A1 && c <= 0x30FA) || (c >= 0x30FC && c <= 0x30FE) ||
      (c >= 0x3105 && c <= 0x312F) || (c >= 0x3131 && c <= 0x318E) ||
      (c >= 0x3190 && c <= 0x319F) || (c >= 0x31A0 && c <= 0x31BF) ||
      (c >= 0x31C0 && c <= 0x31E3) || (c >= 0x31F0 && c <= 0x31FF) ||
      (c >= 0x3200 && c <= 0x321E) || (c >= 0x3220 && c <= 0x3247) ||
      (c >= 0x3251 && c <= 0x4DBF) || (c >= 0x4E00 && c <= 0xA014) ||
      (c >= 0xA016 && c <= 0xA48C) || (c >= 0xA490 && c <= 0xA4C6) ||
      (c >= 0xA960 && c <= 0xA97C) || (c >= 0xAC00 && c <= 0xD7A3) ||
      (c >= 0xF900 && c <= 0xFAFF) || (c >= 0xFE10 && c <= 0xFE16) ||
      (c >= 0xFE31 && c <= 0xFE52) || (c >= 0xFE54 && c <= 0xFE66) ||
      (c >= 0xFE68 && c <= 0xFE6B) || (c >= 0xFF01 && c <= 0xFF60) ||
      (c >= 0xFFE0 && c <= 0xFFE6) || (c >= 0x16FE0 && c <= 0x16FE4) ||
      (c >= 0x17000 && c <= 0x187F7) || (c >= 0x18800 && c <= 0x18CD5) ||
      (c >= 0x18D00 && c <= 0x18D08) || (c >= 0x1AFF0 && c <= 0x1AFF3) ||
      (c >= 0x1AFF5 && c <= 0x1AFFB) || (c >= 0x1AFFD && c <= 0x1AFFE) ||
      (c >= 0x1B000 && c <= 0x1B122) || (c >= 0x1B164 && c <= 0x1B167) ||
      (c >= 0x1B170 && c <= 0x1B2FB) || (c >= 0x1F191 && c <= 0x1F19A) ||
      (c >= 0x1F210 && c <= 0x1F23B) || (c >= 0x1F240 && c <= 0x1F248) ||
      (c >= 0x1F260 && c <= 0x1F265) || (c >= 0x1F300 && c <= 0x1F320) ||
      (c >= 0x1F32D && c <= 0x1F335) || (c >= 0x1F337 && c <= 0x1F37C) ||
      (c >= 0x1F37E && c <= 0x1F393) || (c >= 0x1F3A0 && c <= 0x1F3CA) ||
      (c >= 0x1F3CF && c <= 0x1F3D3) || (c >= 0x1F3E0 && c <= 0x1F3F0) ||
      (c >= 0x1F3F8 && c <= 0x1F43E) || (c >= 0x1F442 && c <= 0x1F4FC) ||
      (c >= 0x1F4FF && c <= 0x1F53D) || (c >= 0x1F54B && c <= 0x1F54E) ||
      (c >= 0x1F550 && c <= 0x1F567) || (c >= 0x1F5FB && c <= 0x1F64F) ||
      (c >= 0x1F680 && c <= 0x1F6C5) || (c >= 0x1F6D0 && c <= 0x1F6D2) ||
      (c >= 0x1F6DC && c <= 0x1F6DF) || (c >= 0x1F6F4 && c <= 0x1F6FC) ||
      (c >= 0x1F7E0 && c <= 0x1F7EB) || (c >= 0x1F90C && c <= 0x1F93A) ||
      (c >= 0x1F93C && c <= 0x1F945) || (c >= 0x1F947 && c <= 0x1F9FF) ||
      (c >= 0x1FA70 && c <= 0x1FA7C) || (c >= 0x1FA80 && c <= 0x1FA88) ||
      (c >= 0x1FA90 && c <= 0x1FABD) || (c >= 0x1FABF && c <= 0x1FAC5) ||
      (c >= 0x1FACE && c <= 0x1FADB) || (c >= 0x1FAE0 && c <= 0x1FAE8) ||
      (c >= 0x1FAF0 && c <= 0x1FAF8) || (c >= 0x20000 && c <= 0x2FFFD) ||
      (c >= 0x30000 && c <= 0x3FFFD)) {
    return 2;
  }

  return 1;
}
